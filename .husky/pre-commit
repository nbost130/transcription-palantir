#!/bin/sh
# Pre-commit hook: Run quality checks before allowing commit

# Get list of staged files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# Check if only markdown files are staged
NON_MD_FILES=$(echo "$STAGED_FILES" | grep -v '\.md$' || true)

if [ -z "$NON_MD_FILES" ]; then
  echo "ğŸ“ Only markdown files detected - skipping code quality checks"
  exit 0
fi

echo "ğŸ”¨ Checking TypeScript compilation..."
npm run build || exit 1

echo "ğŸ¨ Checking code quality (Biome: linting & formatting)..."
npm run biome:check || exit 1

echo "ğŸ“ Checking file sizes (max 500 lines)..."
npm run check:size || exit 1

echo "âœ… Running tests..."
npm run test:seq || exit 1

echo "âœ¨ All checks passed! Proceeding with commit..."
